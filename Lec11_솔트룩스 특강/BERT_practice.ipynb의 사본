{"nbformat":4,"nbformat_minor":5,"metadata":{"accelerator":"GPU","colab":{"name":"BERT_practice.ipynb의 사본","provenance":[{"file_id":"1-XKW30EbtJZu0iD-WtK-KhLTKsTmN8wg","timestamp":1632814827577}],"collapsed_sections":[]},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.7.9"},"widgets":{"application/vnd.jupyter.widget-state+json":{"ec05e03f741e488a9ada41289c8b86c6":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_506526dbc7ae4e1dbfa3ec2419deb68f","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_a75c132d54ce4df7b25d6fa82ec86ea1","IPY_MODEL_62a3a019c6ce4dbfbb7480a37779d706"]}},"506526dbc7ae4e1dbfa3ec2419deb68f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a75c132d54ce4df7b25d6fa82ec86ea1":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_fe634bdaa286490089eecdb6d9570ad9","_dom_classes":[],"description":"100%","_model_name":"FloatProgressModel","bar_style":"success","max":25,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":25,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_31a89ca9bb554838812dc5dc9e4a0756"}},"62a3a019c6ce4dbfbb7480a37779d706":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_e6386d2022344120b30b2cdc47807930","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 25/25 [00:01&lt;00:00, 23.23ba/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_b47678650608415a990d23ab5c9d7c05"}},"fe634bdaa286490089eecdb6d9570ad9":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"31a89ca9bb554838812dc5dc9e4a0756":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e6386d2022344120b30b2cdc47807930":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"b47678650608415a990d23ab5c9d7c05":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"9286a858fc5b4ea984490f1ebc8dc7fc":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_f843595641194e59b8c21f4ee130cb56","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_528e4b0112a041d5b84558737c4dbb53","IPY_MODEL_5cc7e86caa6649b6ab4ec5e66fde4307"]}},"f843595641194e59b8c21f4ee130cb56":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"528e4b0112a041d5b84558737c4dbb53":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_9458a284382b419f851eae4a3aa1e9a8","_dom_classes":[],"description":"100%","_model_name":"FloatProgressModel","bar_style":"success","max":3,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":3,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_58502bfed29a430c97ce17d46af51b18"}},"5cc7e86caa6649b6ab4ec5e66fde4307":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_f05aef7fdefc48e8ae311ffccfc3854a","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 3/3 [01:15&lt;00:00, 25.18s/ba]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_9c90db4054714f618d4d871c8f477551"}},"9458a284382b419f851eae4a3aa1e9a8":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"58502bfed29a430c97ce17d46af51b18":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f05aef7fdefc48e8ae311ffccfc3854a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"9c90db4054714f618d4d871c8f477551":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"080e5c531f594c9e8fe92158dc96caba":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_5f1190b349184450a98ff8e093eb685a","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_5bfeea1380e748a99723129051ca1fc3","IPY_MODEL_c0a75482a2394d0fa0e99d3267c1fa44"]}},"5f1190b349184450a98ff8e093eb685a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"5bfeea1380e748a99723129051ca1fc3":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_e8db235701704b4a959f13585f2416a2","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":546,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":546,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_01709602bf7c44a68fdce4d8f283b67e"}},"c0a75482a2394d0fa0e99d3267c1fa44":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_d8f9f5189d2e4c6f8dac4d32497ccf89","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 546/546 [00:10&lt;00:00, 53.7B/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_df54db82c24f4f0ba0b4a34aa00114f2"}},"e8db235701704b4a959f13585f2416a2":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"01709602bf7c44a68fdce4d8f283b67e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d8f9f5189d2e4c6f8dac4d32497ccf89":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"df54db82c24f4f0ba0b4a34aa00114f2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"6642be5d975a4efaa2002ee0b8d3674f":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_3418ba83be344efeb3d879e6d3b3f073","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_72cc263d99814adf81b4b534d18cde3b","IPY_MODEL_4d220a6f4b7d4314a16d87f89a82cec4"]}},"3418ba83be344efeb3d879e6d3b3f073":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"72cc263d99814adf81b4b534d18cde3b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_0e776b0a1a0141d2936d0a173c7ce799","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":248477,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":248477,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_602c808410d347beab48def6d27a9aef"}},"4d220a6f4b7d4314a16d87f89a82cec4":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_77ea45ba57aa4c5b96d62a4bb8860b08","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 248k/248k [00:06&lt;00:00, 36.0kB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_0abf8dccf721410583de5a73506df0c2"}},"0e776b0a1a0141d2936d0a173c7ce799":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"602c808410d347beab48def6d27a9aef":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"77ea45ba57aa4c5b96d62a4bb8860b08":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"0abf8dccf721410583de5a73506df0c2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"2095693416cd44d09e5d94bb7b4a9bcb":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_536d04d54042417abf64a46869bba847","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_e14bc9c5868f4261b1c2bdf111e3695c","IPY_MODEL_6cf0e1347c2e49d6ad77f194b1c79444"]}},"536d04d54042417abf64a46869bba847":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e14bc9c5868f4261b1c2bdf111e3695c":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_94525b6969294ea48083a33834883afe","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":173,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":173,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_f5df7b8070ca4717b9932cb7b6c401cf"}},"6cf0e1347c2e49d6ad77f194b1c79444":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_9371c5c807de4c7ca9064e93e29dfc49","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 173/173 [00:03&lt;00:00, 44.9B/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_56e14ac87b24433eaf438656142c8ddf"}},"94525b6969294ea48083a33834883afe":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"f5df7b8070ca4717b9932cb7b6c401cf":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"9371c5c807de4c7ca9064e93e29dfc49":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"56e14ac87b24433eaf438656142c8ddf":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ad7423c3181342f89b507369a288e217":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_5928cad043a4424485992f60d4d13619","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_5642ca54f5254b69bfffad96c80fe107","IPY_MODEL_4b75b584d1e24d468b82aa6b9b85422d"]}},"5928cad043a4424485992f60d4d13619":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"5642ca54f5254b69bfffad96c80fe107":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_4bf767920bbc4a3eb7f445602c694a35","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":337,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":337,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_598000547a83454a9586e88f8bd6db26"}},"4b75b584d1e24d468b82aa6b9b85422d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_149c79989b3e4eeeb21d313a41d7469e","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 337/337 [00:00&lt;00:00, 3.59kB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_0a1c8f202e2e4acdb11370de623b09a2"}},"4bf767920bbc4a3eb7f445602c694a35":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"598000547a83454a9586e88f8bd6db26":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"149c79989b3e4eeeb21d313a41d7469e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"0a1c8f202e2e4acdb11370de623b09a2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b47eec18478c4b44a2ec609f0f783cec":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_268df1a1a2554098b0c986640cead6ff","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_3df75a712ede4e15ba8b7168022f1f74","IPY_MODEL_1dc21b46213a458da356008132b51dba"]}},"268df1a1a2554098b0c986640cead6ff":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"3df75a712ede4e15ba8b7168022f1f74":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_d3193b62a1d54b6e8054b6d8a8523446","_dom_classes":[],"description":"100%","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_c8318d16dfb841b7a6df52eba5f24365"}},"1dc21b46213a458da356008132b51dba":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_d71f30fdf6d74f16b7ac793f2a5fd520","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1/1 [11:17&lt;00:00, 677.14s/ba]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_5f15b9a87aea4bcf8223944c5060cea3"}},"d3193b62a1d54b6e8054b6d8a8523446":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"c8318d16dfb841b7a6df52eba5f24365":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d71f30fdf6d74f16b7ac793f2a5fd520":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"5f15b9a87aea4bcf8223944c5060cea3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"98683f8171804239812c4740dddc4c0b":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_5a058286b9a040ddad7139547939fb4d","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_255ab9cf1ad24f22bfe5376b5d5f3c29","IPY_MODEL_cf9fac80ccb54df1b04691d5954fa450"]}},"5a058286b9a040ddad7139547939fb4d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"255ab9cf1ad24f22bfe5376b5d5f3c29":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_ca61158db438425b880e276205c35cf6","_dom_classes":[],"description":"100%","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_da0b87c5801f41ddbabb8a70789bbb35"}},"cf9fac80ccb54df1b04691d5954fa450":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_a6b74db3c8d34840adc4913bc1bd3b42","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1/1 [01:01&lt;00:00, 61.80s/ba]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_73644a60902c48668dbd94886c9c4760"}},"ca61158db438425b880e276205c35cf6":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"da0b87c5801f41ddbabb8a70789bbb35":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a6b74db3c8d34840adc4913bc1bd3b42":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"73644a60902c48668dbd94886c9c4760":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a6d4d5af6cf741439582ea5569279f53":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_89a1bf394500478a89ac8c68300a9603","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_01d06f0b1e694be6a622889ff8e4f6f0","IPY_MODEL_a529b97217784db8b89c9f726b851750"]}},"89a1bf394500478a89ac8c68300a9603":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"01d06f0b1e694be6a622889ff8e4f6f0":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_b41a1b6fc6814ad683952f08a797c0f8","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":442694866,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":442694866,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_f18508bc8ac642c6b75712a6ba0c42f6"}},"a529b97217784db8b89c9f726b851750":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_daa1b871c21e4c8dab2d4450b29a89e5","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 443M/443M [00:15&lt;00:00, 28.9MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_3481c736f21b40a492dc70fa3a71380c"}},"b41a1b6fc6814ad683952f08a797c0f8":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"f18508bc8ac642c6b75712a6ba0c42f6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"daa1b871c21e4c8dab2d4450b29a89e5":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"3481c736f21b40a492dc70fa3a71380c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"okKaZm5Xoqri","executionInfo":{"status":"ok","timestamp":1632814909701,"user_tz":-540,"elapsed":6,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}},"outputId":"4dc8ee0c-d56d-4939-ea24-4f042083c398"},"source":["! nvidia-smi"],"id":"okKaZm5Xoqri","execution_count":1,"outputs":[{"output_type":"stream","name":"stdout","text":["Tue Sep 28 07:41:17 2021       \n","+-----------------------------------------------------------------------------+\n","| NVIDIA-SMI 470.63.01    Driver Version: 460.32.03    CUDA Version: 11.2     |\n","|-------------------------------+----------------------+----------------------+\n","| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n","| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n","|                               |                      |               MIG M. |\n","|===============================+======================+======================|\n","|   0  Tesla K80           Off  | 00000000:00:04.0 Off |                    0 |\n","| N/A   59C    P8    31W / 149W |      0MiB / 11441MiB |      0%      Default |\n","|                               |                      |                  N/A |\n","+-------------------------------+----------------------+----------------------+\n","                                                                               \n","+-----------------------------------------------------------------------------+\n","| Processes:                                                                  |\n","|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n","|        ID   ID                                                   Usage      |\n","|=============================================================================|\n","|  No running processes found                                                 |\n","+-----------------------------------------------------------------------------+\n"]}]},{"cell_type":"markdown","metadata":{"id":"_kbUSCb_Egcu"},"source":["# HuggingFace Transformers를 활용한 문장 분류 모델 학습"],"id":"_kbUSCb_Egcu"},{"cell_type":"markdown","metadata":{"id":"of2izij8Eqe0"},"source":["본 노트북에서는 `klue/roberta-base` 모델을 **KLUE** 내 **NLI** 데이터셋을 활용하여 모델을 훈련하는 예제를 다루게 됩니다.\n","\n","학습 과정 이후에는 간단한 예제 코드를 통해 모델이 어떻게 활용되는지도 함께 알아보도록 할 것입니다.\n","\n","모든 소스 코드는 [`huggingface-notebooks`](https://github.com/huggingface/notebooks)를 참고하였습니다.\n","\n","먼저, 노트북을 실행하는데 필요한 라이브러리를 설치합니다. 모델 훈련을 위해서는 `transformers`가, 학습 데이터셋 로드를 위해서는 `datasets` 라이브러리의 설치가 필요합니다. 그 외 모델 성능 검증을 위해 `scipy`, `scikit-learn`을 추가로 설치해주도록 합니다."],"id":"of2izij8Eqe0"},{"cell_type":"code","metadata":{"id":"0kt9EG4ld0Ei","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1632814972711,"user_tz":-540,"elapsed":25622,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}},"outputId":"9e85c02e-252d-409a-ef88-c91878cbaf98"},"source":["! pip install -U transformers==4.7.0 datasets==1.8.0 scipy scikit-learn"],"id":"0kt9EG4ld0Ei","execution_count":2,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting transformers==4.7.0\n","  Downloading transformers-4.7.0-py3-none-any.whl (2.5 MB)\n","\u001b[K     |████████████████████████████████| 2.5 MB 5.3 MB/s \n","\u001b[?25hCollecting datasets==1.8.0\n","  Downloading datasets-1.8.0-py3-none-any.whl (237 kB)\n","\u001b[K     |████████████████████████████████| 237 kB 42.0 MB/s \n","\u001b[?25hRequirement already satisfied: scipy in /usr/local/lib/python3.7/dist-packages (1.4.1)\n","Collecting scipy\n","  Downloading scipy-1.7.1-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.whl (28.5 MB)\n","\u001b[K     |████████████████████████████████| 28.5 MB 47 kB/s \n","\u001b[?25hRequirement already satisfied: scikit-learn in /usr/local/lib/python3.7/dist-packages (0.22.2.post1)\n","Collecting scikit-learn\n","  Downloading scikit_learn-1.0-cp37-cp37m-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (23.1 MB)\n","\u001b[K     |████████████████████████████████| 23.1 MB 5.5 kB/s \n","\u001b[?25hRequirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from transformers==4.7.0) (2.23.0)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.7/dist-packages (from transformers==4.7.0) (1.19.5)\n","Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.7/dist-packages (from transformers==4.7.0) (4.62.2)\n","Collecting sacremoses\n","  Downloading sacremoses-0.0.46-py3-none-any.whl (895 kB)\n","\u001b[K     |████████████████████████████████| 895 kB 49.5 MB/s \n","\u001b[?25hRequirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from transformers==4.7.0) (4.8.1)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from transformers==4.7.0) (21.0)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from transformers==4.7.0) (3.0.12)\n","Collecting huggingface-hub==0.0.8\n","  Downloading huggingface_hub-0.0.8-py3-none-any.whl (34 kB)\n","Collecting tokenizers<0.11,>=0.10.1\n","  Downloading tokenizers-0.10.3-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (3.3 MB)\n","\u001b[K     |████████████████████████████████| 3.3 MB 48.5 MB/s \n","\u001b[?25hRequirement already satisfied: pyyaml in /usr/local/lib/python3.7/dist-packages (from transformers==4.7.0) (3.13)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.7/dist-packages (from transformers==4.7.0) (2019.12.20)\n","Collecting fsspec\n","  Downloading fsspec-2021.9.0-py3-none-any.whl (123 kB)\n","\u001b[K     |████████████████████████████████| 123 kB 46.7 MB/s \n","\u001b[?25hRequirement already satisfied: dill in /usr/local/lib/python3.7/dist-packages (from datasets==1.8.0) (0.3.4)\n","Collecting tqdm>=4.27\n","  Downloading tqdm-4.49.0-py2.py3-none-any.whl (69 kB)\n","\u001b[K     |████████████████████████████████| 69 kB 6.9 MB/s \n","\u001b[?25hRequirement already satisfied: multiprocess in /usr/local/lib/python3.7/dist-packages (from datasets==1.8.0) (0.70.12.2)\n","Collecting xxhash\n","  Downloading xxhash-2.0.2-cp37-cp37m-manylinux2010_x86_64.whl (243 kB)\n","\u001b[K     |████████████████████████████████| 243 kB 46.1 MB/s \n","\u001b[?25hRequirement already satisfied: pyarrow<4.0.0,>=1.0.0 in /usr/local/lib/python3.7/dist-packages (from datasets==1.8.0) (3.0.0)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.7/dist-packages (from datasets==1.8.0) (1.1.5)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests->transformers==4.7.0) (2021.5.30)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->transformers==4.7.0) (3.0.4)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->transformers==4.7.0) (2.10)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests->transformers==4.7.0) (1.24.3)\n","Collecting threadpoolctl>=2.0.0\n","  Downloading threadpoolctl-2.2.0-py3-none-any.whl (12 kB)\n","Requirement already satisfied: joblib>=0.11 in /usr/local/lib/python3.7/dist-packages (from scikit-learn) (1.0.1)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->transformers==4.7.0) (3.5.0)\n","Requirement already satisfied: typing-extensions>=3.6.4 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->transformers==4.7.0) (3.7.4.3)\n","Requirement already satisfied: pyparsing>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging->transformers==4.7.0) (2.4.7)\n","Requirement already satisfied: python-dateutil>=2.7.3 in /usr/local/lib/python3.7/dist-packages (from pandas->datasets==1.8.0) (2.8.2)\n","Requirement already satisfied: pytz>=2017.2 in /usr/local/lib/python3.7/dist-packages (from pandas->datasets==1.8.0) (2018.9)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.7/dist-packages (from python-dateutil>=2.7.3->pandas->datasets==1.8.0) (1.15.0)\n","Requirement already satisfied: click in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers==4.7.0) (7.1.2)\n","Installing collected packages: tqdm, xxhash, tokenizers, threadpoolctl, scipy, sacremoses, huggingface-hub, fsspec, transformers, scikit-learn, datasets\n","  Attempting uninstall: tqdm\n","    Found existing installation: tqdm 4.62.2\n","    Uninstalling tqdm-4.62.2:\n","      Successfully uninstalled tqdm-4.62.2\n","  Attempting uninstall: scipy\n","    Found existing installation: scipy 1.4.1\n","    Uninstalling scipy-1.4.1:\n","      Successfully uninstalled scipy-1.4.1\n","  Attempting uninstall: scikit-learn\n","    Found existing installation: scikit-learn 0.22.2.post1\n","    Uninstalling scikit-learn-0.22.2.post1:\n","      Successfully uninstalled scikit-learn-0.22.2.post1\n","\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n","albumentations 0.1.12 requires imgaug<0.2.7,>=0.2.5, but you have imgaug 0.2.9 which is incompatible.\u001b[0m\n","Successfully installed datasets-1.8.0 fsspec-2021.9.0 huggingface-hub-0.0.8 sacremoses-0.0.46 scikit-learn-1.0 scipy-1.7.1 threadpoolctl-2.2.0 tokenizers-0.10.3 tqdm-4.49.0 transformers-4.7.0 xxhash-2.0.2\n"]}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"yEL6jiU8ou-Q","executionInfo":{"status":"ok","timestamp":1632814976310,"user_tz":-540,"elapsed":3602,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}},"outputId":"ffca6989-5533-44ec-9bb2-06dfe30b13af"},"source":["! pip freeze  | grep transformers\n","! pip freeze  | grep datasets\n","! pip freeze  | grep scipy\n","! pip freeze  | grep scikit-learn\n"],"id":"yEL6jiU8ou-Q","execution_count":3,"outputs":[{"output_type":"stream","name":"stdout","text":["transformers==4.7.0\n","datasets==1.8.0\n","tensorflow-datasets==4.0.1\n","vega-datasets==0.9.0\n","scipy==1.7.1\n","scikit-learn==1.0\n"]}]},{"cell_type":"markdown","metadata":{"id":"8wSLfX-jaIqV"},"source":["## 문장 분류 모델 학습"],"id":"8wSLfX-jaIqV"},{"cell_type":"markdown","metadata":{"id":"92e868b7-3cf7-4977-a6e7-ebbb99ba298e"},"source":["노트북을 실행하는데 필요한 라이브러리들을 모두 임포트합니다."],"id":"92e868b7-3cf7-4977-a6e7-ebbb99ba298e"},{"cell_type":"code","metadata":{"id":"243b461f","executionInfo":{"status":"ok","timestamp":1632815226795,"user_tz":-540,"elapsed":7280,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}}},"source":["import random\n","import logging\n","from IPython.display import display, HTML\n","\n","import numpy as np\n","import pandas as pd\n","import datasets\n","from datasets import load_dataset, load_metric, ClassLabel, Sequence\n","from sklearn import metrics\n","from transformers import AutoTokenizer, AutoModelForSequenceClassification, TrainingArguments, Trainer"],"id":"243b461f","execution_count":4,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"59b1e5ae-471f-461f-850f-4241a6037471"},"source":["학습에 필요한 정보를 변수로 기록합니다.\n","\n","본 노트북에서는 `klue-roberta-base` 모델을 활용하지만, https://huggingface.co/klue 페이지에서 더 다양한 사전학습 언어 모델을 확인하실 수 있습니다.\n","\n","학습 태스크로는 `nli`를, 배치 사이즈로는 32를 지정하겠습니다."],"id":"59b1e5ae-471f-461f-850f-4241a6037471"},{"cell_type":"code","metadata":{"id":"6ecaacbe","executionInfo":{"status":"ok","timestamp":1632817801170,"user_tz":-540,"elapsed":206,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}}},"source":["model_checkpoint = \"klue/roberta-base\"\n","batch_size = 32\n","task = \"nli\""],"id":"6ecaacbe","execution_count":46,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"816b5893-d03e-4c6e-8536-e246b1def987"},"source":["이제 HuggingFace `datasets` 라이브러리에 등록된 KLUE 데이터셋 중, NLI 데이터를 내려받습니다."],"id":"816b5893-d03e-4c6e-8536-e246b1def987"},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":627},"id":"f8feeba0","executionInfo":{"status":"error","timestamp":1632817813788,"user_tz":-540,"elapsed":583,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}},"outputId":"b5f8cdb1-e69e-4ab2-b403-e85d233db3b5"},"source":["klue_datasets = load_dataset(\"klue\", task)"],"id":"f8feeba0","execution_count":47,"outputs":[{"output_type":"error","ename":"FileNotFoundError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mFileNotFoundError\u001b[0m                         Traceback (most recent call last)","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/datasets/load.py\u001b[0m in \u001b[0;36mprepare_module\u001b[0;34m(path, script_version, download_config, download_mode, dataset, force_local_path, dynamic_modules_path, return_resolved_file_path, **download_kwargs)\u001b[0m\n\u001b[1;32m    319\u001b[0m                 \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 320\u001b[0;31m                     \u001b[0mlocal_path\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mcached_path\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mfile_path\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdownload_config\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mdownload_config\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    321\u001b[0m                 \u001b[0;32mexcept\u001b[0m \u001b[0mFileNotFoundError\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/datasets/utils/file_utils.py\u001b[0m in \u001b[0;36mcached_path\u001b[0;34m(url_or_filename, download_config, **download_kwargs)\u001b[0m\n\u001b[1;32m    290\u001b[0m             \u001b[0mmax_retries\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mdownload_config\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmax_retries\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 291\u001b[0;31m             \u001b[0muse_auth_token\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mdownload_config\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0muse_auth_token\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    292\u001b[0m         )\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/datasets/utils/file_utils.py\u001b[0m in \u001b[0;36mget_from_cache\u001b[0;34m(url, cache_dir, force_download, proxies, etag_timeout, resume_download, user_agent, local_files_only, use_etag, max_retries, use_auth_token)\u001b[0m\n\u001b[1;32m    620\u001b[0m         \u001b[0;32melif\u001b[0m \u001b[0mresponse\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32mNone\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0mresponse\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstatus_code\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0;36m404\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 621\u001b[0;31m             \u001b[0;32mraise\u001b[0m \u001b[0mFileNotFoundError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"Couldn't find file at {}\"\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mformat\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0murl\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    622\u001b[0m         \u001b[0m_raise_if_offline_mode_is_enabled\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34mf\"Tried to reach {url}\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mFileNotFoundError\u001b[0m: Couldn't find file at https://raw.githubusercontent.com/huggingface/datasets/1.8.0/datasets/bert/bert.py","\nDuring handling of the above exception, another exception occurred:\n","\u001b[0;31mFileNotFoundError\u001b[0m                         Traceback (most recent call last)","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/datasets/load.py\u001b[0m in \u001b[0;36mprepare_module\u001b[0;34m(path, script_version, download_config, download_mode, dataset, force_local_path, dynamic_modules_path, return_resolved_file_path, **download_kwargs)\u001b[0m\n\u001b[1;32m    331\u001b[0m                         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 332\u001b[0;31m                             \u001b[0mlocal_path\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mcached_path\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mfile_path\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdownload_config\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mdownload_config\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    333\u001b[0m                             logger.warning(\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/datasets/utils/file_utils.py\u001b[0m in \u001b[0;36mcached_path\u001b[0;34m(url_or_filename, download_config, **download_kwargs)\u001b[0m\n\u001b[1;32m    290\u001b[0m             \u001b[0mmax_retries\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mdownload_config\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmax_retries\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 291\u001b[0;31m             \u001b[0muse_auth_token\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mdownload_config\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0muse_auth_token\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    292\u001b[0m         )\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/datasets/utils/file_utils.py\u001b[0m in \u001b[0;36mget_from_cache\u001b[0;34m(url, cache_dir, force_download, proxies, etag_timeout, resume_download, user_agent, local_files_only, use_etag, max_retries, use_auth_token)\u001b[0m\n\u001b[1;32m    620\u001b[0m         \u001b[0;32melif\u001b[0m \u001b[0mresponse\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32mNone\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0mresponse\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstatus_code\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0;36m404\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 621\u001b[0;31m             \u001b[0;32mraise\u001b[0m \u001b[0mFileNotFoundError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"Couldn't find file at {}\"\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mformat\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0murl\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    622\u001b[0m         \u001b[0m_raise_if_offline_mode_is_enabled\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34mf\"Tried to reach {url}\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mFileNotFoundError\u001b[0m: Couldn't find file at https://raw.githubusercontent.com/huggingface/datasets/master/datasets/bert/bert.py","\nDuring handling of the above exception, another exception occurred:\n","\u001b[0;31mFileNotFoundError\u001b[0m                         Traceback (most recent call last)","\u001b[0;32m<ipython-input-47-f9a94f9acb95>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mklue_datasets\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mload_dataset\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"bert\"\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtask\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/datasets/load.py\u001b[0m in \u001b[0;36mload_dataset\u001b[0;34m(path, name, data_dir, data_files, split, cache_dir, features, download_config, download_mode, ignore_verifications, keep_in_memory, save_infos, script_version, use_auth_token, task, **config_kwargs)\u001b[0m\n\u001b[1;32m    713\u001b[0m         \u001b[0mdataset\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    714\u001b[0m         \u001b[0mreturn_resolved_file_path\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 715\u001b[0;31m         \u001b[0muse_auth_token\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0muse_auth_token\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    716\u001b[0m     )\n\u001b[1;32m    717\u001b[0m     \u001b[0;31m# Set the base path for downloads as the parent of the script location\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/datasets/load.py\u001b[0m in \u001b[0;36mprepare_module\u001b[0;34m(path, script_version, download_config, download_mode, dataset, force_local_path, dynamic_modules_path, return_resolved_file_path, **download_kwargs)\u001b[0m\n\u001b[1;32m    341\u001b[0m                                 \u001b[0;34m\"Couldn't find file locally at {}, or remotely at {}.\\n\"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    342\u001b[0m                                 \"The file is also not present on the master branch on github.\".format(\n\u001b[0;32m--> 343\u001b[0;31m                                     \u001b[0mcombined_path\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mgithub_file_path\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    344\u001b[0m                                 )\n\u001b[1;32m    345\u001b[0m                             )\n","\u001b[0;31mFileNotFoundError\u001b[0m: Couldn't find file locally at bert/bert.py, or remotely at https://raw.githubusercontent.com/huggingface/datasets/1.8.0/datasets/bert/bert.py.\nThe file is also not present on the master branch on github."]}]},{"cell_type":"markdown","metadata":{"id":"f90b06e4-3795-435a-aec8-701da9bd5f04"},"source":["다운로드 혹은 로드 후 얻어진 `datasets` 객체를 살펴보면, 훈련 데이터와 검증 데이터가 포함되어 있는 것을 확인할 수 있습니다."],"id":"f90b06e4-3795-435a-aec8-701da9bd5f04"},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"QzlmWQ2DrZ7P","executionInfo":{"status":"ok","timestamp":1632815330966,"user_tz":-540,"elapsed":289,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}},"outputId":"5f249812-6eef-4c5b-ffeb-26683dbe89e4"},"source":["klue_datasets"],"id":"QzlmWQ2DrZ7P","execution_count":7,"outputs":[{"output_type":"execute_result","data":{"text/plain":["DatasetDict({\n","    train: Dataset({\n","        features: ['guid', 'hypothesis', 'label', 'premise', 'source'],\n","        num_rows: 24998\n","    })\n","    validation: Dataset({\n","        features: ['guid', 'hypothesis', 'label', 'premise', 'source'],\n","        num_rows: 3000\n","    })\n","})"]},"metadata":{},"execution_count":7}]},{"cell_type":"markdown","metadata":{"id":"f39_pKKnarD3"},"source":["각 예시 데이터는 아래와 같이 두 개의 문장과 두 문장의 추론 관계를 라벨로 지니고 있습니다."],"id":"f39_pKKnarD3"},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"e46bf44d","executionInfo":{"status":"ok","timestamp":1632815368374,"user_tz":-540,"elapsed":209,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}},"outputId":"f4eb1ea0-fe71-4191-a320-297bf7aefc8c"},"source":["klue_datasets[\"train\"][:10]"],"id":"e46bf44d","execution_count":9,"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'guid': ['klue-nli-v1_train_00000',\n","  'klue-nli-v1_train_00001',\n","  'klue-nli-v1_train_00002',\n","  'klue-nli-v1_train_00003',\n","  'klue-nli-v1_train_00004',\n","  'klue-nli-v1_train_00005',\n","  'klue-nli-v1_train_00006',\n","  'klue-nli-v1_train_00007',\n","  'klue-nli-v1_train_00008',\n","  'klue-nli-v1_train_00009'],\n"," 'hypothesis': ['힛걸 진심 최고로 멋지다.',\n","  '100분간 잤다.',\n","  '소닉붐이 정말 멋있었다.',\n","  '100분간 자는게 더 나았을 것 같다.',\n","  '101빌딩 근처에서 즐길거리 찾기는 어렵습니다.',\n","  '101빌딩 주변에 젊은이들이 즐길거리가 많습니다.',\n","  '101빌딩 부근에서는 여러가지를 즐길수 있습니다.',\n","  '웬디는 피터를 차갑게 맞이했다.',\n","  '잭과 매기는 피터 배닝의 동생들이다.',\n","  '피터 배닝, 잭, 매기는 남매사이다.'],\n"," 'label': [0, 2, 1, 1, 2, 1, 0, 2, 1, 0],\n"," 'premise': ['힛걸 진심 최고다 그 어떤 히어로보다 멋지다',\n","  '100분간 잘껄 그래도 소닉붐땜에 2점준다',\n","  '100분간 잘껄 그래도 소닉붐땜에 2점준다',\n","  '100분간 잘껄 그래도 소닉붐땜에 2점준다',\n","  '101빌딩 근처에 나름 즐길거리가 많습니다.',\n","  '101빌딩 근처에 나름 즐길거리가 많습니다.',\n","  '101빌딩 근처에 나름 즐길거리가 많습니다.',\n","  '10년 만에 찾는 피터를 웬디는 따뜻하게 맞이하고 피터는 성공리에 연설을 마치는데 딴 세상인 마법 섬에서 온 후크선장은 피터 배닝의 남매인 잭과 매기를 납치한다.',\n","  '10년 만에 찾는 피터를 웬디는 따뜻하게 맞이하고 피터는 성공리에 연설을 마치는데 딴 세상인 마법 섬에서 온 후크선장은 피터 배닝의 남매인 잭과 매기를 납치한다.',\n","  '10년 만에 찾는 피터를 웬디는 따뜻하게 맞이하고 피터는 성공리에 연설을 마치는데 딴 세상인 마법 섬에서 온 후크선장은 피터 배닝의 남매인 잭과 매기를 납치한다.'],\n"," 'source': ['NSMC',\n","  'NSMC',\n","  'NSMC',\n","  'NSMC',\n","  'airbnb',\n","  'airbnb',\n","  'airbnb',\n","  'wikipedia',\n","  'wikipedia',\n","  'wikipedia']}"]},"metadata":{},"execution_count":9}]},{"cell_type":"code","metadata":{"id":"DBCr4mGdeC7D","colab":{"base_uri":"https://localhost:8080/","height":118,"referenced_widgets":["ec05e03f741e488a9ada41289c8b86c6","506526dbc7ae4e1dbfa3ec2419deb68f","a75c132d54ce4df7b25d6fa82ec86ea1","62a3a019c6ce4dbfbb7480a37779d706","fe634bdaa286490089eecdb6d9570ad9","31a89ca9bb554838812dc5dc9e4a0756","e6386d2022344120b30b2cdc47807930","b47678650608415a990d23ab5c9d7c05","9286a858fc5b4ea984490f1ebc8dc7fc","f843595641194e59b8c21f4ee130cb56","528e4b0112a041d5b84558737c4dbb53","5cc7e86caa6649b6ab4ec5e66fde4307","9458a284382b419f851eae4a3aa1e9a8","58502bfed29a430c97ce17d46af51b18","f05aef7fdefc48e8ae311ffccfc3854a","9c90db4054714f618d4d871c8f477551"]},"executionInfo":{"status":"ok","timestamp":1632815422641,"user_tz":-540,"elapsed":1482,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}},"outputId":"6b82619e-da4b-4ace-eed1-f21b2275ee9c"},"source":[" datasets = klue_datasets.filter(lambda example, index: index < 500, with_indices=True)"],"id":"DBCr4mGdeC7D","execution_count":10,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"ec05e03f741e488a9ada41289c8b86c6","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, max=25.0), HTML(value='')))"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"9286a858fc5b4ea984490f1ebc8dc7fc","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, max=3.0), HTML(value='')))"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["\n"]}]},{"cell_type":"code","metadata":{"id":"X0Ez8ViWeIaL","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1632815422641,"user_tz":-540,"elapsed":9,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}},"outputId":"bd4d3536-4076-453d-8509-e48960432ec9"},"source":["datasets"],"id":"X0Ez8ViWeIaL","execution_count":11,"outputs":[{"output_type":"execute_result","data":{"text/plain":["DatasetDict({\n","    train: Dataset({\n","        features: ['guid', 'hypothesis', 'label', 'premise', 'source'],\n","        num_rows: 500\n","    })\n","    validation: Dataset({\n","        features: ['guid', 'hypothesis', 'label', 'premise', 'source'],\n","        num_rows: 500\n","    })\n","})"]},"metadata":{},"execution_count":11}]},{"cell_type":"markdown","metadata":{"id":"pc1BXYLYaupD"},"source":["데이터셋을 전반적으로 살펴보기 위한 시각화 함수를 다음과 같이 정의합니다."],"id":"pc1BXYLYaupD"},{"cell_type":"code","metadata":{"id":"8110a3ee","executionInfo":{"status":"ok","timestamp":1632815422642,"user_tz":-540,"elapsed":7,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}}},"source":["def show_random_elements(dataset, num_examples=10):\n","    assert num_examples <= len(dataset), \"Can't pick more elements than there are in the dataset.\"\n","\n","    picks = []\n","    \n","    for _ in range(num_examples):\n","        pick = random.randint(0, len(dataset)-1)\n","\n","        # 이미 등록된 예제가 뽑힌 경우, 다시 추출\n","        while pick in picks:\n","            pick = random.randint(0, len(dataset)-1)\n","\n","        picks.append(pick)\n","\n","    # 임의로 추출된 인덱스들로 구성된 데이터 프레임 선언\n","    df = pd.DataFrame(dataset[picks])\n","\n","    for column, typ in dataset.features.items():\n","        # 라벨 클래스를 스트링으로 변환\n","        if isinstance(typ, ClassLabel):\n","            df[column] = df[column].transform(lambda i: typ.names[i])\n","\n","    display(HTML(df.to_html()))"],"id":"8110a3ee","execution_count":12,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"u1Ia2wGh1xaF"},"source":["앞서 정의한 함수를 활용해 훈련 데이터를 살펴보도록 합시다.\n","\n","이처럼 데이터를 살펴보는 것의 장점으로는 각 라벨에 어떠한 문장들이 해당하는지에 대한 감을 익힐 수 있다는데에 있습니다.\n","\n","**KLUE NLI**는 `entailment`, `neutral` 그리고 `contradiction` 세 개의 라벨을 지니는 데이터셋임을 확인할 수 있습니다."],"id":"u1Ia2wGh1xaF"},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":553},"id":"8c7888d1","scrolled":true,"executionInfo":{"status":"ok","timestamp":1632815422643,"user_tz":-540,"elapsed":7,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}},"outputId":"542d49a5-e314-4209-843d-1667179c0a2b"},"source":["show_random_elements(datasets[\"train\"])"],"id":"8c7888d1","execution_count":13,"outputs":[{"output_type":"display_data","data":{"text/html":["<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>guid</th>\n","      <th>hypothesis</th>\n","      <th>label</th>\n","      <th>premise</th>\n","      <th>source</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>klue-nli-v1_train_00349</td>\n","      <td>기업들은 과감하게 4조원 규모의 투자를 했다.</td>\n","      <td>neutral</td>\n","      <td>1조9,000억원 규모의 녹색 융자 및 2,150억원 규모의 민관 합동 펀드를 조성, 기업들의 과감한 투자를 뒷받침한다.</td>\n","      <td>policy</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>klue-nli-v1_train_00377</td>\n","      <td>1편의 신선함과 2편의 화끈함이 전부 없어지다니.</td>\n","      <td>entailment</td>\n","      <td>1편의 신선함과 2편의 화끈함이 모조리 증발해 버리다니.</td>\n","      <td>NSMC</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>klue-nli-v1_train_00433</td>\n","      <td>십자가 형태의 나무에 못박혀 죽은 시신이 여러 구 발견되었다.</td>\n","      <td>neutral</td>\n","      <td>2011년 5월 1일에 경상북도 문경시에 있는 한 폐광산에서 십자가 형태의 나무에 못박혀 죽은 남성 시신이 발견되었다.</td>\n","      <td>wikinews</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>klue-nli-v1_train_00116</td>\n","      <td>300년째 주민들에게 소중한 농업용수를 공급해주는 저수지는 10년의 공사기간을 거쳐 1720년에 완공되었다.</td>\n","      <td>neutral</td>\n","      <td>1720년대 완공되어 300년째 주민들에게 소중한 농업용수를 공급해주는 저수지인데, 한 영화에 나오며 아름다운 풍경을 가진 곳으로 사람들에게 입소문을 탔다.</td>\n","      <td>wikinews</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>klue-nli-v1_train_00276</td>\n","      <td>1993년에는 경상북도에서만 조직이 결성됐다.</td>\n","      <td>contradiction</td>\n","      <td>1993년 전라남도 함평군 대동면에서 부유층에 대한 증오를 행동으로 나타내자며 조직을 결성하였다.</td>\n","      <td>wikinews</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>klue-nli-v1_train_00261</td>\n","      <td>완벽한 허구를 가지고 영화를 만들었다.</td>\n","      <td>contradiction</td>\n","      <td>1991년 8월 음주운전을 하던 조씨가 길을 가던 여성을 뺑소니한 뒤 시신을 유기한 사건을 모티브로 한 영화이다.</td>\n","      <td>NSMC</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>klue-nli-v1_train_00466</td>\n","      <td>이 씨의 자살 이유는 생활고였다.</td>\n","      <td>neutral</td>\n","      <td>2016년 9월 1일 한강에 투신한 이 씨는 이튿날 숨진 채 발견됐다.</td>\n","      <td>wikitree</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>klue-nli-v1_train_00260</td>\n","      <td>외규장각 도서의 환수는 대한민국의 요청으로 시작되었다.</td>\n","      <td>neutral</td>\n","      <td>1991년 4월 25일에 시작된 대한민국과 프랑스 간의 외규장각 도서의 환수가 2011년 6월 11일부터 한 달간 진행되었다.</td>\n","      <td>wikinews</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>klue-nli-v1_train_00318</td>\n","      <td>영화를 보는 내내 기분이 좋았다.</td>\n","      <td>contradiction</td>\n","      <td>1시간 20분부터 완전 눈버리고 기분잡친 영화</td>\n","      <td>NSMC</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>klue-nli-v1_train_00496</td>\n","      <td>2019년 근로자 휴가지원 사업이 근로의욕을 평균 30프로 향상시킨 것으로 나타났다.</td>\n","      <td>neutral</td>\n","      <td>2019년 근로자 휴가지원 사업이 국내 관광 활성화와 근로의욕 향상에 크게 기여한 것으로 나타났다.</td>\n","      <td>policy</td>\n","    </tr>\n","  </tbody>\n","</table>"],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{}}]},{"cell_type":"markdown","metadata":{"id":"zakMS4Y61sLm"},"source":["훈련 과정 중 모델의 성능을 파악하기 위한 메트릭을 설정합니다.\n","\n","`datasets` 라이브러리에는 이미 구현된 메트릭을 사용할 수 있는 `load_metric` 함수가 있습니다.\n","\n","그 중 **GLUE** 데이터셋에 이미 다양한 메트릭이 구현되어 있으므로, **GLUE** 그 중에서도 **KLUE NLI**와 동일한 `accuracy` 메트릭을 사용하는 `qnli` 태스크의 메트릭을 사용합니다."],"id":"zakMS4Y61sLm"},{"cell_type":"markdown","metadata":{"id":"I07wSysL2fRs"},"source":["`accuracy` 메트릭이 정상적으로 작동하는지 확인하기 위해, 랜덤한 예측 값과 라벨 값을 생성합니다."],"id":"I07wSysL2fRs"},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"e988c49f","executionInfo":{"status":"ok","timestamp":1632815462537,"user_tz":-540,"elapsed":210,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}},"outputId":"7d6709d1-0f3c-4fe9-d945-c2b3cbaf322a"},"source":["fake_preds = np.random.randint(0, 2, size=(64,))\n","fake_labels = np.random.randint(0, 2, size=(64,))\n","fake_preds, fake_labels"],"id":"e988c49f","execution_count":14,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(array([1, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1,\n","        1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1,\n","        0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1]),\n"," array([0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 1, 1, 0, 1,\n","        1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0,\n","        0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1]))"]},"metadata":{},"execution_count":14}]},{"cell_type":"markdown","metadata":{"id":"ryxIEDZR2oR-"},"source":["앞서 생성한 랜덤 예측, 랜덤 라벨 값을 `compute()` 함수에 입력해 잘 동작하는지 확인해봅시다."],"id":"ryxIEDZR2oR-"},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"e2dcf392-5c0a-4bbb-b9f6-cc42be6a382a","executionInfo":{"status":"ok","timestamp":1632815462790,"user_tz":-540,"elapsed":9,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}},"outputId":"278ee952-d7f5-4e38-eb3d-1519470daaeb"},"source":["# metric = load_metric(\"glue\", \"qnli\")\n","metrics.accuracy_score(y_true=fake_preds, y_pred=fake_labels)"],"id":"e2dcf392-5c0a-4bbb-b9f6-cc42be6a382a","execution_count":15,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.484375"]},"metadata":{},"execution_count":15}]},{"cell_type":"markdown","metadata":{"id":"rPvvy_wC24i_"},"source":["이제 학습에 활용할 토크나이저를 로드해오도록 합니다."],"id":"rPvvy_wC24i_"},{"cell_type":"code","metadata":{"id":"b64e70af","colab":{"base_uri":"https://localhost:8080/","height":218,"referenced_widgets":["080e5c531f594c9e8fe92158dc96caba","5f1190b349184450a98ff8e093eb685a","5bfeea1380e748a99723129051ca1fc3","c0a75482a2394d0fa0e99d3267c1fa44","e8db235701704b4a959f13585f2416a2","01709602bf7c44a68fdce4d8f283b67e","d8f9f5189d2e4c6f8dac4d32497ccf89","df54db82c24f4f0ba0b4a34aa00114f2","6642be5d975a4efaa2002ee0b8d3674f","3418ba83be344efeb3d879e6d3b3f073","72cc263d99814adf81b4b534d18cde3b","4d220a6f4b7d4314a16d87f89a82cec4","0e776b0a1a0141d2936d0a173c7ce799","602c808410d347beab48def6d27a9aef","77ea45ba57aa4c5b96d62a4bb8860b08","0abf8dccf721410583de5a73506df0c2","2095693416cd44d09e5d94bb7b4a9bcb","536d04d54042417abf64a46869bba847","e14bc9c5868f4261b1c2bdf111e3695c","6cf0e1347c2e49d6ad77f194b1c79444","94525b6969294ea48083a33834883afe","f5df7b8070ca4717b9932cb7b6c401cf","9371c5c807de4c7ca9064e93e29dfc49","56e14ac87b24433eaf438656142c8ddf","ad7423c3181342f89b507369a288e217","5928cad043a4424485992f60d4d13619","5642ca54f5254b69bfffad96c80fe107","4b75b584d1e24d468b82aa6b9b85422d","4bf767920bbc4a3eb7f445602c694a35","598000547a83454a9586e88f8bd6db26","149c79989b3e4eeeb21d313a41d7469e","0a1c8f202e2e4acdb11370de623b09a2"]},"executionInfo":{"status":"ok","timestamp":1632815515232,"user_tz":-540,"elapsed":17520,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}},"outputId":"43199c95-8da7-46fe-becf-68c8659e0cca"},"source":["tokenizer = AutoTokenizer.from_pretrained(model_checkpoint, use_fast=True)"],"id":"b64e70af","execution_count":16,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"080e5c531f594c9e8fe92158dc96caba","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=546.0, style=ProgressStyle(description_…"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"6642be5d975a4efaa2002ee0b8d3674f","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=248477.0, style=ProgressStyle(descripti…"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"2095693416cd44d09e5d94bb7b4a9bcb","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=173.0, style=ProgressStyle(description_…"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"ad7423c3181342f89b507369a288e217","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=337.0, style=ProgressStyle(description_…"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["\n"]}]},{"cell_type":"markdown","metadata":{"id":"YIVjwvm428Q_"},"source":["로드된 토크나이저가 두 개 문장을 토큰화하는 방식을 파악하기 위해 두 문장을 입력 값으로 넣어줘보도록 합시다."],"id":"YIVjwvm428Q_"},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"0520aba3","executionInfo":{"status":"ok","timestamp":1632815660081,"user_tz":-540,"elapsed":227,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}},"outputId":"b081e046-181a-4426-f58a-908d83f8b6ae"},"source":["tokenizer(\"힛걸 진심 최고로 멋지다.\", \"힛걸 진심 최고다 그 어떤 히어로보다 멋지다\")"],"id":"0520aba3","execution_count":17,"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'input_ids': [0, 3, 7254, 3841, 2200, 11980, 2062, 18, 2, 3, 7254, 3841, 2062, 636, 3711, 12717, 2178, 2062, 11980, 2062, 2], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]}"]},"metadata":{},"execution_count":17}]},{"cell_type":"markdown","metadata":{"id":"FDAaxujL7l1X"},"source":["`input_ids`를 보시면 `cls_token`에 해당하는 2번 토큰이 가장 좌측에 붙게 되며, `sep_token`의 3번 토큰이 각각 중간과 가장 우측에 더해진 것을 확인할 수 있습니다.\n","\n","이제 앞서 로드한 데이터셋에서 각 문장에 해당하는 *value* 를 뽑아주기 위한 *key* 를 정의합니다.\n","\n","앞서 **KLUE NLI** 데이터셋의 두 문장은 각각 `premise`와 `hypothesis`라는 이름으로 정의된 것을 확인하였으니, 두 문장의 *key* 는 마찬가지로 각각 `premise`, `hypothesis`가 되게 됩니다."],"id":"FDAaxujL7l1X"},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"95127c8c","executionInfo":{"status":"ok","timestamp":1632815682357,"user_tz":-540,"elapsed":216,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}},"outputId":"a6d822f7-49ab-4e8d-94d0-a90d67e3dd0e"},"source":["sentence1_key, sentence2_key = (\"premise\", \"hypothesis\")\n","print(f\"Sentence 1: {datasets['train'][0][sentence1_key]}\")\n","print(f\"Sentence 2: {datasets['train'][0][sentence2_key]}\")"],"id":"95127c8c","execution_count":18,"outputs":[{"output_type":"stream","name":"stdout","text":["Sentence 1: 힛걸 진심 최고다 그 어떤 히어로보다 멋지다\n","Sentence 2: 힛걸 진심 최고로 멋지다.\n"]}]},{"cell_type":"markdown","metadata":{"id":"fMDIRs1M4-5a"},"source":["이제 *key* 도 확인이 되었으니, 데이터셋에서 각 예제들을 뽑아와 토큰화 할 수 있는 함수를 아래와 같이 정의해줍니다.\n","\n","해당 함수는 모델을 훈련하기 앞서 데이터셋을 미리 토큰화 시켜놓는 작업을 위한 콜백 함수로 사용되게 됩니다.\n","\n","인자로 넣어주는 `truncation`는 모델이 입력 받을 수 있는 최대 길이 이상의 토큰 시퀀스가 들어오게 될 경우, 최대 길이 기준으로 시퀀스를 자르라는 의미를 지닙니다.\n","\n","( \\* `return_token_type_ids`는 토크나이저가 `token_type_ids`를 반환하도록 할 것인지를 결정하는 인자입니다. `transformers==4.7.0` 기준으로 `token_type_ids`가 기본적으로 반환되므로 `token_type_ids` 자체를 사용하지 않는 `RoBERTa` 모델을 활용하기 위해 해당 인자를 `False`로 설정해주도록 합니다.)"],"id":"fMDIRs1M4-5a"},{"cell_type":"code","metadata":{"id":"2f8f8cc0","executionInfo":{"status":"ok","timestamp":1632815716935,"user_tz":-540,"elapsed":218,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}}},"source":["def preprocess_function(examples):\n","    return tokenizer(\n","        examples[sentence1_key],\n","        examples[sentence2_key],\n","        truncation=True, # 최대크기 넘으면 자름\n","        return_token_type_ids=False,\n","    )"],"id":"2f8f8cc0","execution_count":19,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"F-qK5fgl4_6t"},"source":["앞서 정의한 `process_function`은 여러 개의 예제 데이터를 받을 수도 있습니다."],"id":"F-qK5fgl4_6t"},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"x8KrAGLpyxNO","executionInfo":{"status":"ok","timestamp":1632815718693,"user_tz":-540,"elapsed":211,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}},"outputId":"9b510d34-ded3-4d5e-ee33-cb796708d3ef"},"source":["preprocess_function(datasets[\"train\"][:5])"],"id":"x8KrAGLpyxNO","execution_count":20,"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'input_ids': [[0, 3, 7254, 3841, 2062, 636, 3711, 12717, 2178, 2062, 11980, 2062, 2, 3, 7254, 3841, 2200, 11980, 2062, 18, 2], [0, 3911, 2377, 2366, 1521, 3061, 4785, 1282, 2955, 3308, 3515, 2170, 22, 2532, 5675, 2, 3911, 2377, 2366, 1525, 2062, 18, 2], [0, 3911, 2377, 2366, 1521, 3061, 4785, 1282, 2955, 3308, 3515, 2170, 22, 2532, 5675, 2, 1282, 2955, 3308, 2052, 3944, 11580, 2359, 2062, 18, 2], [0, 3911, 2377, 2366, 1521, 3061, 4785, 1282, 2955, 3308, 3515, 2170, 22, 2532, 5675, 2, 3911, 2377, 2366, 5105, 2318, 831, 717, 2886, 2069, 575, 555, 2062, 18, 2], [0, 10522, 2548, 2500, 6328, 2170, 6189, 5916, 4015, 2116, 1039, 2219, 3606, 18, 2, 10522, 2548, 2500, 6328, 27135, 5916, 4015, 1642, 2015, 2259, 4258, 2219, 3606, 18, 2]], 'attention_mask': [[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]]}"]},"metadata":{},"execution_count":20}]},{"cell_type":"markdown","metadata":{"id":"a_usMC7U5AyW"},"source":["이제 정의된 전처리 함수를 활용해 데이터셋을 미리 토큰화시키는 작업을 수행합니다.\n","\n","`datasets` 라이브러리를 통해 얻어진 `DatasetDict` 객체는 `map()` 함수를 지원하므로, 정의된 전처리 함수를 데이터셋 토큰화를 위한 콜백 함수로 `map()` 함수 인자로 넘겨주면 됩니다.\n","\n","보다 자세한 내용은 [문서](https://huggingface.co/docs/datasets/processing.html#processing-data-with-map)를 참조해주시면 됩니다."],"id":"a_usMC7U5AyW"},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":118,"referenced_widgets":["b47eec18478c4b44a2ec609f0f783cec","268df1a1a2554098b0c986640cead6ff","3df75a712ede4e15ba8b7168022f1f74","1dc21b46213a458da356008132b51dba","d3193b62a1d54b6e8054b6d8a8523446","c8318d16dfb841b7a6df52eba5f24365","d71f30fdf6d74f16b7ac793f2a5fd520","5f15b9a87aea4bcf8223944c5060cea3","98683f8171804239812c4740dddc4c0b","5a058286b9a040ddad7139547939fb4d","255ab9cf1ad24f22bfe5376b5d5f3c29","cf9fac80ccb54df1b04691d5954fa450","ca61158db438425b880e276205c35cf6","da0b87c5801f41ddbabb8a70789bbb35","a6b74db3c8d34840adc4913bc1bd3b42","73644a60902c48668dbd94886c9c4760"]},"id":"f7c72286","executionInfo":{"status":"ok","timestamp":1632815771945,"user_tz":-540,"elapsed":610,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}},"outputId":"d6bac383-1039-448e-e667-3d1ed1309c05"},"source":["encoded_datasets = datasets.map(preprocess_function, batched=True)"],"id":"f7c72286","execution_count":21,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"b47eec18478c4b44a2ec609f0f783cec","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, max=1.0), HTML(value='')))"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"98683f8171804239812c4740dddc4c0b","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, max=1.0), HTML(value='')))"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["\n"]}]},{"cell_type":"markdown","metadata":{"id":"n6p7zIL75Bif"},"source":["학습을 위한 모델을 로드할 차례입니다.\n","\n","앞서 살펴본 바와 같이 **KLUE NLI**에는 총 3개의 클래스가 존재하므로, 3개의 클래스를 예측할 수 있는 *SequenceClassification* 구조로 모델을 로드하도록 합니다."],"id":"n6p7zIL75Bif"},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":181,"referenced_widgets":["a6d4d5af6cf741439582ea5569279f53","89a1bf394500478a89ac8c68300a9603","01d06f0b1e694be6a622889ff8e4f6f0","a529b97217784db8b89c9f726b851750","b41a1b6fc6814ad683952f08a797c0f8","f18508bc8ac642c6b75712a6ba0c42f6","daa1b871c21e4c8dab2d4450b29a89e5","3481c736f21b40a492dc70fa3a71380c"]},"id":"7ae93dd8","executionInfo":{"status":"ok","timestamp":1632815833763,"user_tz":-540,"elapsed":17210,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}},"outputId":"5bc4b7ea-6a3f-46be-de70-8ae6d4b13113"},"source":["num_labels = 3\n","model = AutoModelForSequenceClassification.from_pretrained(model_checkpoint, num_labels=num_labels)"],"id":"7ae93dd8","execution_count":22,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"a6d4d5af6cf741439582ea5569279f53","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=442694866.0, style=ProgressStyle(descri…"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["\n"]},{"output_type":"stream","name":"stderr","text":["Some weights of the model checkpoint at klue/roberta-base were not used when initializing RobertaForSequenceClassification: ['lm_head.decoder.bias', 'lm_head.dense.bias', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight', 'lm_head.bias', 'lm_head.layer_norm.weight', 'lm_head.dense.weight']\n","- This IS expected if you are initializing RobertaForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing RobertaForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n","Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at klue/roberta-base and are newly initialized: ['classifier.dense.weight', 'classifier.out_proj.weight', 'classifier.out_proj.bias', 'classifier.dense.bias']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n"]}]},{"cell_type":"markdown","metadata":{"id":"ZSc4c6K5oR_R"},"source":["모델을 로드할 때 발생하는 경고 문구는 두 가지 의미를 지닙니다.\n","\n","1. *Masked Language Modeling* 을 위해 존재했던 `lm_head`가 현재는 사용되지 않고 있음을 의미합니다.\n","2. 문장 분류를 위한 `classifier` 레이어를 백본 모델 뒤에 이어 붙였으나 아직 훈련이 되지 않았으므로, 학습을 수행해야 함을 의미합니다."],"id":"ZSc4c6K5oR_R"},{"cell_type":"markdown","metadata":{"id":"x6bvKcsv5CPo"},"source":["마지막으로 앞서 정의한 메트릭을 모델 예측 결과에 적용하기 위한 함수를 정의합니다.\n","\n","입력으로 들어오는 `eval_pred`는 [*EvalPrediction*](https://huggingface.co/transformers/internal/trainer_utils.html#transformers.EvalPrediction) 객체이며, 모델의 클래스 별 예측 값과 정답 값을 지닙니다.\n","\n","클래스 별 예측 중 가장 높은 라벨을 `argmax()`를 통해 뽑아낸 후, 정답 라벨과 비교를 하게 됩니다."],"id":"x6bvKcsv5CPo"},{"cell_type":"code","metadata":{"id":"cbfb67d3","executionInfo":{"status":"ok","timestamp":1632816008570,"user_tz":-540,"elapsed":218,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}}},"source":["def compute_metrics(eval_pred):\n","    predictions, labels = eval_pred\n","    predictions = np.argmax(predictions, axis=1)\n","    return {'accuracy': metrics.accuracy_score(y_true=labels, y_pred=predictions)}  # metric.compute(predictions=predictions, references=labels)"],"id":"cbfb67d3","execution_count":23,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"aU_dmMAVE_FA"},"source":["이제 앞서 정의한 정보들을 바탕으로 `transformers`에서 제공하는 *Trainer* 객체를 활용하기 위한 인자 관리 클래스를 초기화합니다.\n","\n","`metric_name`은 앞서 얻어진 메트릭 함수를 활용했을 때, 아래와 같이 `dict` 형식으로 결과 값이 반환되는데 여기서 우리가 사용할 *key* 를 정의해준다고 생각하시면 됩니다.\n","\n","```python\n",">>> metrics.accuracy_score(y_true=labels, y_pred=predictions) \n","{'accuracy': 0.515625}\n","```\n","\n","각 인자에 대한 자세한 설명은 [문서](https://huggingface.co/transformers/main_classes/trainer.html#trainingarguments)에서 참조해주시면 됩니다."],"id":"aU_dmMAVE_FA"},{"cell_type":"code","metadata":{"id":"864b6408","executionInfo":{"status":"ok","timestamp":1632816035531,"user_tz":-540,"elapsed":220,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}}},"source":["metric_name = \"accuracy\"\n","\n","args = TrainingArguments(\n","    \"test-nli\",\n","    evaluation_strategy=\"epoch\",\n","    learning_rate=2e-5,\n","    per_device_train_batch_size=batch_size,\n","    per_device_eval_batch_size=batch_size,\n","    num_train_epochs=10,\n","    weight_decay=0.01,\n","    load_best_model_at_end=True,\n","    metric_for_best_model=metric_name,\n",")"],"id":"864b6408","execution_count":24,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"PcvI6ZHe3Ty6"},"source":["이제 로드한 모델, 인자 관리 클래스, 데이터셋 등을 *Trainer* 클래스를 초기화에 넘겨주도록 합니다.\n","\n","(TIP: Q: 이미 `encoded_datasets`을 만드는 과정에 토큰화가 이루어졌는데 토크나이저를 굳이 넘겨주는 이유가 무엇인가요?,<br>A: 토큰화는 이루어졌지만 학습 과정 시, 데이터를 배치 단위로 넘겨주는 과정에서 배치에 포함된 가장 긴 시퀀스 기준으로 `truncation`을 수행하고 최대 길이 시퀀스 보다 짧은 시퀀스들은 그 길이만큼 `padding`을 수행해주기 위함입니다.)"],"id":"PcvI6ZHe3Ty6"},{"cell_type":"code","metadata":{"id":"c91650f2","executionInfo":{"status":"ok","timestamp":1632816046945,"user_tz":-540,"elapsed":9392,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}}},"source":["trainer = Trainer(\n","    model,\n","    args,\n","    train_dataset=encoded_datasets[\"train\"],\n","    eval_dataset=encoded_datasets[\"validation\"],\n","    tokenizer=tokenizer,\n","    compute_metrics=compute_metrics,\n",")"],"id":"c91650f2","execution_count":25,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"KImxQi1ZFAO4"},"source":["이제 정의된 *Trainer* 객체를 다음과 같이 훈련시킬 수 있습니다.\n","\n","에폭이 지남에 따라 *Loss* 는 떨어지고, 앞서 선정한 메트릭인 *Accuracy* 는 증가하는 것을 확인할 수 있습니다."],"id":"KImxQi1ZFAO4"},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":271},"id":"73261f8e","executionInfo":{"status":"ok","timestamp":1632816198299,"user_tz":-540,"elapsed":141407,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}},"outputId":"304042ff-8747-4ff7-fea8-16f7d2330d1e"},"source":["trainer.train()"],"id":"73261f8e","execution_count":26,"outputs":[{"output_type":"display_data","data":{"text/html":["\n","    <div>\n","      \n","      <progress value='80' max='80' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [80/80 02:20, Epoch 5/5]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: left;\">\n","      <th>Epoch</th>\n","      <th>Training Loss</th>\n","      <th>Validation Loss</th>\n","      <th>Accuracy</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <td>1</td>\n","      <td>No log</td>\n","      <td>1.100767</td>\n","      <td>0.332000</td>\n","    </tr>\n","    <tr>\n","      <td>2</td>\n","      <td>No log</td>\n","      <td>1.097782</td>\n","      <td>0.348000</td>\n","    </tr>\n","    <tr>\n","      <td>3</td>\n","      <td>No log</td>\n","      <td>1.095931</td>\n","      <td>0.370000</td>\n","    </tr>\n","    <tr>\n","      <td>4</td>\n","      <td>No log</td>\n","      <td>1.084463</td>\n","      <td>0.416000</td>\n","    </tr>\n","    <tr>\n","      <td>5</td>\n","      <td>No log</td>\n","      <td>1.068225</td>\n","      <td>0.470000</td>\n","    </tr>\n","  </tbody>\n","</table><p>"],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["TrainOutput(global_step=80, training_loss=1.0901834487915039, metrics={'train_runtime': 141.114, 'train_samples_per_second': 17.716, 'train_steps_per_second': 0.567, 'total_flos': 117157643281224.0, 'train_loss': 1.0901834487915039, 'epoch': 5.0})"]},"metadata":{},"execution_count":26}]},{"cell_type":"markdown","metadata":{"id":"avS6mBu8779g"},"source":["*Trainer* 는 학습을 마치게 되면, `load_best_model_at_end=True` 인자에 따라 메트릭 기준 가장 좋은 성능을 보였던 체크포인트를 로드하게 됩니다.\n","\n","본 노트북에서는 마지막 에폭 때 가장 좋은 성능을 얻었기에 `evaluate`를 수행해도 같은 결과가 나오겠습니다."],"id":"avS6mBu8779g"},{"cell_type":"code","metadata":{"id":"58239e17","colab":{"base_uri":"https://localhost:8080/","height":148},"executionInfo":{"status":"ok","timestamp":1632816202549,"user_tz":-540,"elapsed":4263,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}},"outputId":"d31de32f-c15b-4f47-c079-5d3edeb8ef8c"},"source":["trainer.evaluate()"],"id":"58239e17","execution_count":27,"outputs":[{"output_type":"display_data","data":{"text/html":["\n","    <div>\n","      \n","      <progress value='16' max='16' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [16/16 00:03]\n","    </div>\n","    "],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["{'epoch': 5.0,\n"," 'eval_accuracy': 0.47,\n"," 'eval_loss': 1.0682246685028076,\n"," 'eval_runtime': 4.3321,\n"," 'eval_samples_per_second': 115.419,\n"," 'eval_steps_per_second': 3.693}"]},"metadata":{},"execution_count":27}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"G04qcLC1wnOO","executionInfo":{"status":"ok","timestamp":1632816377990,"user_tz":-540,"elapsed":218,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}},"outputId":"ff102aa2-fcab-47f4-a324-9cb58e6763ce"},"source":["print(model.config.id2label, model.config.label2id )"],"id":"G04qcLC1wnOO","execution_count":28,"outputs":[{"output_type":"stream","name":"stdout","text":["{0: 'LABEL_0', 1: 'LABEL_1', 2: 'LABEL_2'} {'LABEL_0': 0, 'LABEL_1': 1, 'LABEL_2': 2}\n"]}]},{"cell_type":"markdown","metadata":{"id":"2LlWOiDIwd0D"},"source":["모델을 저장하기 전에, id2label과 label2id로 임시의 라벨 텍스트로 저장되어 있는 것을 변환해야합니다."],"id":"2LlWOiDIwd0D"},{"cell_type":"code","metadata":{"id":"pcTlNqFvvba7","executionInfo":{"status":"ok","timestamp":1632816412059,"user_tz":-540,"elapsed":227,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}}},"source":["dict_temp = {}\n","for k, v in model.config.id2label.items():\n","  label_text = datasets[\"train\"].features['label'].int2str(k)  \n","  dict_temp[k] = label_text\n","\n","model.config.id2label = dict_temp\n","model.config.label2id = {_label:_id for _id, _label in dict_temp.items()}"],"id":"pcTlNqFvvba7","execution_count":29,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"SLAOJrpjwTex"},"source":["원하는 경로에 모델 저장합니다."],"id":"SLAOJrpjwTex"},{"cell_type":"code","metadata":{"id":"wnoKMVOKvOsp","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1632816433183,"user_tz":-540,"elapsed":1723,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}},"outputId":"4284b5d2-cc06-4d5e-ed88-a90f52af109b"},"source":["model.save_pretrained('/root/0928_save_model')\n","tokenizer.save_pretrained('/root/0928_save_model')"],"id":"wnoKMVOKvOsp","execution_count":30,"outputs":[{"output_type":"execute_result","data":{"text/plain":["('/root/0928_save_model/tokenizer_config.json',\n"," '/root/0928_save_model/special_tokens_map.json',\n"," '/root/0928_save_model/vocab.txt',\n"," '/root/0928_save_model/added_tokens.json',\n"," '/root/0928_save_model/tokenizer.json')"]},"metadata":{},"execution_count":30}]},{"cell_type":"markdown","metadata":{"id":"IYJN2p61wXWa"},"source":["모델이 잘 저장되어있는지 확인합니다."],"id":"IYJN2p61wXWa"},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"EiC0ZXBrsryi","executionInfo":{"status":"ok","timestamp":1632816435605,"user_tz":-540,"elapsed":565,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}},"outputId":"df8df282-2f86-4cbd-82a3-69303d0ff6f4"},"source":["! ls /root/0928_save_model -la"],"id":"EiC0ZXBrsryi","execution_count":31,"outputs":[{"output_type":"stream","name":"stdout","text":["total 432952\n","drwxr-xr-x 2 root root      4096 Sep 28 08:06 .\n","drwx------ 1 root root      4096 Sep 28 08:06 ..\n","-rw-r--r-- 1 root root       926 Sep 28 08:06 config.json\n","-rw-r--r-- 1 root root 442567085 Sep 28 08:06 pytorch_model.bin\n","-rw-r--r-- 1 root root       156 Sep 28 08:06 special_tokens_map.json\n","-rw-r--r-- 1 root root       543 Sep 28 08:06 tokenizer_config.json\n","-rw-r--r-- 1 root root    494911 Sep 28 08:06 tokenizer.json\n","-rw-r--r-- 1 root root    248477 Sep 28 08:06 vocab.txt\n"]}]},{"cell_type":"markdown","metadata":{"id":"SkNpAqSJ78oM"},"source":["모델을 저장한 후에, 아래 예제와 같이 `pipeline` 함수를 통해 사용이 가능합니다.\n","\n","먼저 `text-classification` 태스크로 파이프라인 객체를 초기화합니다.\n","\n","( \\* `return_all_scores`는 모델이 입력 문장에 대해 측정한 각 라벨에 대한 확률 값을 모두 보여줄 것인지를 결정하는 인자입니다.)"],"id":"SkNpAqSJ78oM"},{"cell_type":"code","metadata":{"id":"htUZ0ws19Ksk","executionInfo":{"status":"ok","timestamp":1632816450206,"user_tz":-540,"elapsed":2770,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}}},"source":["from transformers import pipeline\n","\n","classifier = pipeline(\n","    \"text-classification\",\n","    model=\"/root/0928_save_model\",\n","    return_all_scores=True,\n",")"],"id":"htUZ0ws19Ksk","execution_count":32,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"2uW7UQgBFBPw"},"source":["NLI는 두 문장의 페어를 입력 값으로 주어야 하기 때문에 구분자 스페셜 토큰을 두 문장 사이에 넣어주기 위해 토크나이저 객체를 로드합니다.\n","\n","`[SEP]` 문자열을 하드코딩하여 넣어줄 수도 있겠지만, 스페셜 토큰은 토크나이저 마다 다르게 정의되므로 다른 모델을 활용할 때 보다 코드를 재사용할 수 있도록 토크나이저의 `sep_token` 프로퍼티에 접근하는 방식으로 코드를 작성합니다."],"id":"2uW7UQgBFBPw"},{"cell_type":"code","metadata":{"id":"UoXTmep0Dcwg","executionInfo":{"status":"ok","timestamp":1632816457988,"user_tz":-540,"elapsed":245,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}}},"source":["tokenizer = AutoTokenizer.from_pretrained(\"/root/0928_save_model\")"],"id":"UoXTmep0Dcwg","execution_count":33,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":36},"id":"MuOQhiVPDiMq","executionInfo":{"status":"ok","timestamp":1632816467534,"user_tz":-540,"elapsed":206,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}},"outputId":"51ac216b-e784-4423-e285-275b1062623b"},"source":["tokenizer.sep_token"],"id":"MuOQhiVPDiMq","execution_count":34,"outputs":[{"output_type":"execute_result","data":{"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"},"text/plain":["'[SEP]'"]},"metadata":{},"execution_count":34}]},{"cell_type":"markdown","metadata":{"id":"iCP9OgWHFDLG"},"source":["`sep_token`으로 두 문장을 이어 하나의 입력 값으로 파이프라인에 넘겨줍니다.\n","\n","입력된 문장에 대해 모델이 각 라벨에 대해 어떤 확률을 가지고 예측했는지를 확인할 수 있습니다."],"id":"iCP9OgWHFDLG"},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"tVCGIVQDChcQ","executionInfo":{"status":"ok","timestamp":1632816471904,"user_tz":-540,"elapsed":519,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}},"outputId":"4f9a5194-bc65-4052-e466-f33f4ec96e94"},"source":["classifier(f\"흡연하려면 발코니 있는 방을 선택하면 됩니다. {tokenizer.sep_token} 흡연자분들은 발코니가 있는 방이면 발코니에서 흡연이 가능합니다.\")"],"id":"tVCGIVQDChcQ","execution_count":35,"outputs":[{"output_type":"execute_result","data":{"text/plain":["[[{'label': 'entailment', 'score': 0.3343855142593384},\n","  {'label': 'neutral', 'score': 0.35155126452445984},\n","  {'label': 'contradiction', 'score': 0.31406328082084656}]]"]},"metadata":{},"execution_count":35}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Ud2kuxlNCmGI","executionInfo":{"status":"ok","timestamp":1632816472128,"user_tz":-540,"elapsed":3,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}},"outputId":"a433e592-cbbd-49b4-a76f-45cec602be59"},"source":["classifier(f\"호스트분은 영어밖에 못하십니다. {tokenizer.sep_token} 호스트분도 엄청 친절하시고 영어도 잘하십니다.\")"],"id":"Ud2kuxlNCmGI","execution_count":36,"outputs":[{"output_type":"execute_result","data":{"text/plain":["[[{'label': 'entailment', 'score': 0.30899298191070557},\n","  {'label': 'neutral', 'score': 0.3490909934043884},\n","  {'label': 'contradiction', 'score': 0.3419160544872284}]]"]},"metadata":{},"execution_count":36}]},{"cell_type":"markdown","metadata":{"id":"Uvx8PPTsrPyC"},"source":["검증 데이터에 존재하는 임의의 문장 페어를 입력해보니, 우리가 원하던 결과를 얻을 수 있었습니다.\n","\n","*(cf. NLI 데이터에 대해 학습된 모델을 활용해 Zero-shot Classification을 수행하는 예제가 궁금하신 분들은 해당 [노트북](https://colab.research.google.com/github/Huffon/klue-transformers-tutorial/blob/master/zero_shot_classification.ipynb)을 참조해주세요.)*"],"id":"Uvx8PPTsrPyC"},{"cell_type":"markdown","metadata":{"id":"xnGNRH-YdYID"},"source":["# 실습문제 1\n"],"id":"xnGNRH-YdYID"},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":715},"id":"sBdBcFgWciDN","executionInfo":{"status":"error","timestamp":1632817732134,"user_tz":-540,"elapsed":68191,"user":{"displayName":"조현기","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"02064242295340458415"}},"outputId":"93d0cacd-3cf4-4cbb-9d0d-13c1bd143d1c"},"source":["eval_list = []\n","batch_size = [16, 96, 128, 156, 512, 1024]\n","num_train_epoch = [10]\n","learning_rate = [0.00001, 0.0001, 0.001, 0.01, 0.1, 1]\n","weight_decay = [0, 0.1, 0.01]\n","\n","\n","for batch in batch_size:\n","  for epoch_num in num_train_epoch:\n","    for rate in learning_rate:\n","      for weight in weight_decay:\n","        print('\\n', '==================================================================================')\n","        print(batch, epoch_num, rate, weight, '시작')\n","        model = AutoModelForSequenceClassification.from_pretrained(model_checkpoint, num_labels=num_labels)\n","        metric_name = \"accuracy\"\n","\n","        args = TrainingArguments(\n","            \"test-nli\",\n","            evaluation_strategy=\"epoch\",\n","            learning_rate=rate,\n","            per_device_train_batch_size=batch,\n","            per_device_eval_batch_size=batch,\n","            num_train_epochs=epoch_num,\n","            weight_decay=weight,\n","            load_best_model_at_end=True,\n","            metric_for_best_model=metric_name,\n","        )\n","\n","        trainer = Trainer(\n","            model,\n","            args,\n","            train_dataset=encoded_datasets[\"train\"],\n","            eval_dataset=encoded_datasets[\"validation\"],\n","            tokenizer=tokenizer,\n","            compute_metrics=compute_metrics,\n","        )\n","\n","        trainer.train()\n","        eval = trainer.evaluate()\n","        print(eval)\n","        eval_list.append((eval, batch, epoch_num, rate, weight))"],"id":"sBdBcFgWciDN","execution_count":42,"outputs":[{"output_type":"stream","name":"stdout","text":["\n"," ==================================================================================\n","16 10 1e-05 0 시작\n"]},{"output_type":"stream","name":"stderr","text":["Some weights of the model checkpoint at klue/roberta-base were not used when initializing RobertaForSequenceClassification: ['lm_head.decoder.bias', 'lm_head.dense.bias', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight', 'lm_head.bias', 'lm_head.layer_norm.weight', 'lm_head.dense.weight']\n","- This IS expected if you are initializing RobertaForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing RobertaForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n","Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at klue/roberta-base and are newly initialized: ['classifier.dense.weight', 'classifier.out_proj.weight', 'classifier.out_proj.bias', 'classifier.dense.bias']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n"]},{"output_type":"display_data","data":{"text/html":["\n","    <div>\n","      \n","      <progress value='97' max='320' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [ 97/320 01:05 < 02:33, 1.45 it/s, Epoch 3/10]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: left;\">\n","      <th>Epoch</th>\n","      <th>Training Loss</th>\n","      <th>Validation Loss</th>\n","      <th>Accuracy</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <td>1</td>\n","      <td>No log</td>\n","      <td>1.099906</td>\n","      <td>0.332000</td>\n","    </tr>\n","    <tr>\n","      <td>2</td>\n","      <td>No log</td>\n","      <td>1.096855</td>\n","      <td>0.360000</td>\n","    </tr>\n","  </tbody>\n","</table><p>\n","    <div>\n","      \n","      <progress value='1' max='32' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [ 1/32 : < :]\n","    </div>\n","    "],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{}},{"output_type":"error","ename":"KeyboardInterrupt","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)","\u001b[0;32m<ipython-input-42-0a6f9a622fde>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m     36\u001b[0m         )\n\u001b[1;32m     37\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 38\u001b[0;31m         \u001b[0mtrainer\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtrain\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     39\u001b[0m         \u001b[0meval\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtrainer\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mevaluate\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     40\u001b[0m         \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0meval\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/transformers/trainer.py\u001b[0m in \u001b[0;36mtrain\u001b[0;34m(self, resume_from_checkpoint, trial, **kwargs)\u001b[0m\n\u001b[1;32m   1323\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1324\u001b[0m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcontrol\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcallback_handler\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mon_epoch_end\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstate\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcontrol\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1325\u001b[0;31m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_maybe_log_save_evaluate\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtr_loss\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtrial\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mepoch\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1326\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1327\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mDebugOption\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mTPU_METRICS_DEBUG\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdebug\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/transformers/trainer.py\u001b[0m in \u001b[0;36m_maybe_log_save_evaluate\u001b[0;34m(self, tr_loss, model, trial, epoch)\u001b[0m\n\u001b[1;32m   1410\u001b[0m         \u001b[0mmetrics\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1411\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcontrol\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshould_evaluate\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1412\u001b[0;31m             \u001b[0mmetrics\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mevaluate\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1413\u001b[0m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_report_to_hp_search\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtrial\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mepoch\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mmetrics\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1414\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/transformers/trainer.py\u001b[0m in \u001b[0;36mevaluate\u001b[0;34m(self, eval_dataset, ignore_keys, metric_key_prefix)\u001b[0m\n\u001b[1;32m   2015\u001b[0m             \u001b[0mprediction_loss_only\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcompute_metrics\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mNone\u001b[0m \u001b[0;32melse\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2016\u001b[0m             \u001b[0mignore_keys\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mignore_keys\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 2017\u001b[0;31m             \u001b[0mmetric_key_prefix\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mmetric_key_prefix\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   2018\u001b[0m         )\n\u001b[1;32m   2019\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/transformers/trainer.py\u001b[0m in \u001b[0;36mevaluation_loop\u001b[0;34m(self, dataloader, description, prediction_loss_only, ignore_keys, metric_key_prefix)\u001b[0m\n\u001b[1;32m   2184\u001b[0m                 \u001b[0mlosses_host\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mlosses\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0mlosses_host\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mNone\u001b[0m \u001b[0;32melse\u001b[0m \u001b[0mtorch\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcat\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mlosses_host\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlosses\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdim\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2185\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mlogits\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 2186\u001b[0;31m                 \u001b[0mlogits\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_pad_across_processes\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mlogits\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   2187\u001b[0m                 \u001b[0mlogits\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_nested_gather\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mlogits\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2188\u001b[0m                 \u001b[0mpreds_host\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mlogits\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0mpreds_host\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mNone\u001b[0m \u001b[0;32melse\u001b[0m \u001b[0mnested_concat\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpreds_host\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlogits\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mpadding_index\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m-\u001b[0m\u001b[0;36m100\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.7/dist-packages/transformers/trainer.py\u001b[0m in \u001b[0;36m_pad_across_processes\u001b[0;34m(self, tensor, pad_index)\u001b[0m\n\u001b[1;32m   2296\u001b[0m             \u001b[0;32mreturn\u001b[0m \u001b[0mtensor\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2297\u001b[0m         \u001b[0;31m# Gather all sizes\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 2298\u001b[0;31m         \u001b[0msize\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtorch\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtensor\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtensor\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mshape\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdevice\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mtensor\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdevice\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;32mNone\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   2299\u001b[0m         \u001b[0msizes\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_nested_gather\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0msize\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcpu\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2300\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mKeyboardInterrupt\u001b[0m: "]}]},{"cell_type":"code","metadata":{"id":"DtHvcH82eCIE"},"source":[""],"id":"DtHvcH82eCIE","execution_count":null,"outputs":[]}]}